
<!DOCTYPE html>
<html>
  <head>

    <title>Scala hacker guide - Scala Documentation</title>
    
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <link rel="icon" type="image/png" href="/resources/favicon.ico">

    <!-- prettify js and CSS -->
    <link rel="stylesheet" href="/resources/stylesheets/prettify.css" type="text/css" />
    <script src="/resources/javascript/prettify/prettify.js" type="text/javascript" ></script>

    <!-- jquery js -->
    <script src="/resources/javascript/jquery.js" type="text/javascript" ></script>
    <script src="/resources/javascript/effects.core.js" type="text/javascript" ></script>
    <script src="/resources/javascript/effects.highlight.js" type="text/javascript" ></script>
    <script src="/resources/javascript/moveScroller.js" type="text/javascript" ></script>

    <!-- Bootstrap JS and CSS -->
    <link rel="stylesheet" href="/resources/stylesheets/bootstrap.css" type="text/css" />
	<script src="/resources/javascript/bootstrap-dropdown.js" type="text/javascript" ></script>
	<script src="/resources/javascript/bootstrap-dropdown-app.js" type="text/javascript" ></script>	

    <!-- Base stylesheet for all pages -->
    <link rel="stylesheet" href="/resources/stylesheets/base.css" type="text/css" />

    <!-- You may want to change the paths below, according to your own CSS and JavaScript setup -->
    <script type="text/javascript" src="/resources/javascript/jquery.easing.js"></script>
    <script type="text/javascript" src="/resources/javascript/jquery.accordionza.js"></script>
    <script src="/resources/javascript/frontpage.js" type="text/javascript" ></script>

    <!-- table of contents js -->
    <script src="/resources/javascript/toc.js" type="text/javascript" ></script>

    <!-- google analytics -->
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-574683-5']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();

	</script>


    <!-- prettyprint js to prepend generated pre/code tags -->
   <script type="text/javascript">
      function styleCode() 
        {
          if (typeof disableStyleCode != "undefined") 
          {
              return;
          }
          var a = false;
          $("pre code").parent().each(function() 
          {
              if (!$(this).hasClass("prettyprint")) 
              {
                  $(this).addClass("prettyprint lang-scala linenums");
                  a = true
              }
          });
          if (a) { prettyPrint() } 
      }
    </script>

    <script type="text/javascript">
      jQuery(document).ready(function($) {

            $(".scroll").click(function(event){		
              event.preventDefault();
              $('html,body').animate({scrollTop:$(this.hash).offset().top}, 500);
              $('html,body').animate({scrollTop:$(this.hash).offset().top-=50}, 500);
              $(this.hash).effect("highlight", {color: "#FFCC85"}, 3000);
            });
      });
    </script>


    <style type="text/css">
      html, body {
	     padding-top: 36px; 
	     height: 100%;
	     background:url(/resources/images/bg-short.jpg) no-repeat top center #310808; 	 	 
		  -webkit-box-shadow: inset 0 10px 50px rgba(0,0,0,.6);
		     -moz-box-shadow: inset 0 10px 50px rgba(0,0,0,.6);
		/*          box-shadow: inset 0 10px 30px rgba(0,0,0,.3);*/
	  }

      input, textarea, select, .uneditable-input {
	       width: 165px;
	   }
		
	  .scrollingmenu {
		  width: 940px;
		  margin-left: auto;
		  margin-right: auto;
		  height: 70px;
		  zoom: 1;		
	}
	.scrollingmenu h1 {
      padding-bottom: 30px;
	  color: #ffffff;
	  font-size: 42px;
	  line-height: 1;
	  text-shadow: 0 1px 2px rgba(0,0,0,.5);
	}
    .container {
	   min-height: 100%;
    }
    .bottom {
	   min-height: 100%;
	   background-color: #ffffff;
	   padding-top: 20px;
	   border-top: 1px solid #8e397d;
	}
	.bottom h1,h2,h3 {
		text-shadow: 0 1px 2px rgba(255,255,255,.5);
	}
	.bottom h1,h2,h3 a {
                color: #404040;
		text-shadow: 0 1px 2px rgba(255,255,255,.5);
	}

	.bottom small {
                color: #808080;
		text-shadow: 0 1px 1px rgba(255,255,255,.5);
	}

	.bottom p.under {
                color: #808080;
		text-shadow: 0 1px 1px rgba(255,255,255,.5);
		font-size: 18px;
		line-height: 36px;
		margin-top: -25px;
	}

        .bottom ul.thanks {
                margin: 10px 0 4px 25px;
                list-style: square;
        }

        .bottom ul.thanks li {
                color: #404040;
                font-size: 16px;
                line-height: 22px;
                margin: 0px;
         }

        .page-header-index{margin-bottom:17px;border-bottom:1px solid #808080;-webkit-box-shadow:0 1px 0 rgba(255, 255, 255, 0.5);-moz-box-shadow:0 1px 0 rgba(255, 255, 255, 0.5);box-shadow:0 1px 0 rgba(255, 255, 255, 0.5);}

       p.contents {
           font-weight: bold;
           font-size: 16px;
       }

       div#toc ul {
           list-style: none;
       }

       div#toc ul a {
           display: block;
           list-style: none;
           line-height: 22px;
           font-weight: bold;
           width: 100%;
       }

      div#toc ul li ul {
           list-style: disc;
      }

      div#toc ul li ul a {
           line-height: 18px;
           font-weight: normal;
      }

      div#toc ul li ul li ul {
           list-style: square;
      }
       div#toc ul li ul li ul a {
       }

       div#scroller-anchor {
           width: inherit;
       }

       div#scroller {
           width: inherit;
       }

       p#about {
      	 margin-top: -8px;
         padding-left: 14px;
       }

       ul {
	     margin-left: 15px;
       }


   </style>

</head>
  <body>


<div class="wrapper">
      <!-- Topbar
    ================================================== -->
<div class="topbar">
    <div class="topbar-inner">
        <div class="container">
            <a class="brand" href="/index.html"><img src="/resources/images/scala-logo.png"> Documentation</a>
            <ul class="nav">

                <li class="menu">
                      <a href="#" class="menu">API</a>
                      <ul class="menu-dropdown">
                        <li><a href="http://www.scala-lang.org/api/current/">Current</a></li>
                        <li><a href="http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html">Nightly</a></li>
                        <!--<li class="divider"></li>
                        <li><a href="#">Previous Versions</a></li>
                        -->
                      </ul>
                </li>

                <li class="menu">
                      <a href="#" class="menu">Learn</a>
                      <ul class="menu-dropdown">
                        <li><a href="/overviews">Guides & Overviews</a></li>
                        <li><a href="/tutorials">Tutorials</a></li>
                        <li><a href="/style">Scala Style Guide</a></li>
                      </ul>
                </li>

                <li class="menu">
                      <a href="#" class="menu">Quickref</a>
                      <ul class="menu-dropdown">
                        <li><a href="/glossary">Glossary</a></li>
                        <li><a href="/cheatsheets">Cheatsheets</a></li>
                      </ul>
                </li>

                <li><a href="/contribute.html">Contribute</a></li>
                <li><a href="/sips">SIPs</a></li>
                <li><a href="http://wiki.scala-lang.org">Wiki</a></li>
          </ul>
          <form method="get" id="searchform" action="/search.html">
            <input type="text" placeholder="Search"  class="field" name="q" id="q"/>
          </form>
           </li>
          </ul>
        </div>
    </div>
</div>

  <header class="scrollingmenu">
    <h1>Scala hacker guide</h1>
  </header>

  <div class="bottom">
    <div class="container">
      <div class="row">

        <div class="span11">
          <p><strong>Eugene Burmako</strong></p>

<p>PREVIEW VERSION, MEANT TO LIVE ELSEWHERE</p>

<p>PLEASE DO NOT REPOST/TWEET THIS GUIDE</p>

<p>SO THAT WE DON&#8217;T HAVE TO UPDATE BROKEN LINKS LATER</p>

<p>This guide is intended to help you get from an idea of fixing a bug or implementing a new feature to a nightly and, ultimately, to a production release of Scala incorporating your idea. Being able to influence a programming language of your choice is amazing, and I&#8217;m excited to demonstrate that it&#8217;s easier than one might think.</p>

<h3 id='the_running_example'>The running example</h3>

<p>I like string interpolation a lot. Doing debug prints with interpolators introduced in Scala 2.10.0 is so enjoyable that I often wonder how we ever lived without that feature. However there&#8217;s an annoying issue which I occasionally stumble upon: the formatting string interpolator <code>f</code> <a href='https://issues.scala-lang.org/browse/SI-6725'>does not support</a> new line tokens <code>%n</code>. I could go the mailing list, ask to fix this bug and then indefinitely wait for the fix. Or I could instead patch Scala myself and get the fix in a subsequent release (nightly builds get produced, well, every night, minor releases are pumped every few months and major releases happen once a year). The latter option sounds cool, so let&#8217;s see how it works!</p>

<h3 id='1_connect'>1. Connect</h3>

<p>Sometimes it&#8217;s appealing to hack alone and not to have to interact with humans, but in the context of such a big project like Scala this might not be the very best idea. Our community has people who spent years accumulating knowledge about Scala. They might provide unique insights and, what&#8217;s even better, direct assistance in their areas.</p>

<p>Typically bug fixes and especially new features beging with posting to one of <a href='TODO'>our mailing lists</a> to find out how people feel about things you want to implement. People proficient is certain areas of Scala usually monitor mailing lists, so you&#8217;ll often get some help by simply posting a message. But the most efficient way to connect is to cc your message to one of the go-to persons in your area. Here&#8217;s the list of people (Github usernames and real-life names) and their specialties:</p>

<pre><code>library: @phaller (Philipp Haller), @axel22 (Aleksandar Prokopec -- concurrent &amp; collection)
specialisation: @axel22 (Aleksander Prokopec), @vladureche (Vlad Ureche), @dragos (Iulian Dragos)
named / default args, annotations, plugins: @lrytz (Lukas Rytz)
macros, reflection, manifests, type tags: @xeno-by (Eugene Burmako), @cvogt (Christopher Vogt)
type checker, inference: @odersky (Martin Odersky), @adriaanm (Adriaan Moors)
language specification, string interpolation, value classes: @odersky (Martin Odersky)
new pattern matcher, implicit search: @adriaanm (Adriaan Moors)
partest, Continuations Plugin: @phaller (Philipp Haller)
error handling, lazy vals: @hubertp (Hubert Plociniczak)
backend: @magarciaEPFL (Miguel Garcia), @gkossakowski (Grzegorz Kossakowski), @dragos (Iulian Dragos)
repl, compiler performance: @paulp (Paul Phillips)
swing: @ingoem (Ingo Maier)
scaladoc: @vladureche (Vlad Ureche)
optimizer: @vladureche (Vlad Ureche), @magarciaEPFL (Miguel Garcia)
build: @jsuereth (Josh Suereth)
random compiler bugs: @lrytz, @adriaanm, @hubertp
documentation: @heathermiller (Heather Miller)
cps: @TiarkRompf (Tiark Rompf)</code></pre>

<p>Martin is the one who submitted the string interpolation proposal and implemented this language feature for Scala 2.10.0. (TODO: how to choose a mailing list) Therefore now I&#8217;m going to <a href='http://groups.google.com/group/scala-user'>the scala-user mailing list</a> and will post a topic about my issue. Note that I put Martin in the cc list of the email. If I didn&#8217;t do that, he would probably miss it in a bunch of emails, which get posted to scala-user every day.</p>

<p><img alt='Posting to scala-user' src='/tutorials/01-post.png' /></p>

<p><img alt='Response from Martin' src='/tutorials/02-post.png' /></p>

<p>Now when I have the approval of the feature&#8217;s author, I&#8217;ll get to work!</p>

<h3 id='2_set_up'>2. Set up</h3>

<p>Hacking Scala begins with creating a branch for your work item. To develop Scala we use <a href='http://git-scm.com/'>Git</a> and <a href='http://github.com/'>GitHub</a>. This section of the guide provides a short walkthrough, but if you are new to Git, it probably makes sense to familiarize with Git first. We recommend the <a href='http://git-scm.com/book/en/'>Git Pro</a> online book.</p>

<h3 id='fork'>Fork</h3>

<p>Log into <a href='http://github.com/'>GitHub</a>, go to <a href='https://github.com/scala/scala'>https://github.com/scala/scala</a> and click the <code>Fork</code> button at the top of the page. This will create your own copy of our repository that will serve as a scratchpad for your hackings. If you&#8217;re new to Git, don&#8217;t be afraid of messing it up - there is no way you can corrupt our repository.</p>

<p><img alt='Fork scala/scala' src='/tutorials/03-fork.png' /></p>

<h3 id='clone'>Clone</h3>

<p>If everything went okay, you will be redirected to your own fork at <code>https://github.com/username/scala</code>, where <code>username</code> is your github user name. You might find it helpful to read <a href='http://help.github.com/fork-a-repo/'>http://help.github.com/fork-a-repo/</a>, which covers some of the things that will follow below. Then clone your repository by running something like the following on the command line:</p>

<pre><code>16:35 ~/Projects$ git clone https://github.com/xeno-by/scala
Cloning into &#39;scala&#39;...
remote: Counting objects: 258564, done.
remote: Compressing objects: 100% (58239/58239), done.
remote: Total 258564 (delta 182155), reused 254094 (delta 178356)
Receiving objects: 100% (258564/258564), 46.91 MiB | 700 KiB/s, done.
Resolving deltas: 100% (182155/182155), done.</code></pre>

<p>This will create a local directory called <code>scala</code>, which contains a clone of your own copy of our repository. The changes that you make in this directory can be propagated back to your copy and, ultimately, pushed into Scala.</p>

<h3 id='branch'>Branch</h3>

<p>Before you start making changes, always create your own branch. Never work on the <code>master</code> branch. Think of a name that describes the changes you plan on doing. Use a prefix that describes the nature of your change. There are essentially two kinds of changes: bug fixes and new features.</p>

<ul>
<li>For bug fixes, use <code>issue/NNNN</code> for bug NNNN from the <a href='https://issues.scala-lang.org/'>Scala issue tracker</a>.</li>

<li>For new feature use <code>topic/XXX</code> for feature XXX. Use feature names that make sense in the context of the whole Scala project and not just to you personally. For example, if you work on diagrams in Scaladoc, use <code>topic/scaladoc-diagrams</code> instead of just <code>topic/diagrams</code>.</li>
</ul>

<p>Since I&#8217;m going to fix an existing bug <a href='https://issues.scala-lang.org/browse/SI-6725'>SI-6725</a>, I&#8217;ll create a branch named <code>ticket/6725</code>.</p>

<pre><code>16:39 ~/Projects/scala (master)$ git checkout -b ticket/6725
Switched to a new branch &#39;ticket/6725&#39;</code></pre>

<p>If you are new to Git and branching, read the <a href='http://git-scm.com/book/en/Git-Branching'>Branching Chapter</a> in the Git Pro book.</p>

<h3 id='build'>Build</h3>

<p>The next step after cloning your fork is setting up your machine to build Scala. The definitive guide on building Scala is located at <a href='https://github.com/scala/scala/blob/master/README.rst'>https://github.com/scala/scala/blob/master/README.rst</a>, but here&#8217;s the summary:</p>

<ul>
<li>It is recommended to use Java <code>1.6</code> (not <code>1.7</code> or <code>1.8</code>, because they might cause occasional glitches).</li>

<li>The build tool is <code>ant</code>.</li>

<li>The build runs the <code>pull-binary-libs.sh</code> script to download bootstrap libs. This requires <code>bash</code> and <code>curl</code>.</li>

<li>The majority of our team works on Linux and OS X, so these operating systems are guaranteed to work.</li>

<li>Windows is supported, but it might have issues. Please report to <a href='https://issues.scala-lang.org/'>the issue tracker</a> if you encounter them.</li>
</ul>

<p>In a nutshell, building Scala is as easy as running <code>ant</code> in the root of your clone. Be prepared to wait for a while - a full rebuild takes 8+ minutes depending on your machine. Incremental builds are usually within 30-120 seconds range (again, your mileage might vary with your hardware).</p>

<pre><code>16:50 ~/Projects/scala (ticket/6725)$ ant
Buildfile: /Users/xeno_by/Projects/scala/build.xml

strap.clean:

pack.clean:

init.jars.check:

init.jars:
     [echo] Updating bootstrap libs.  (To do this by hand, run ./pull-binary-libs.sh)
     [exec] Resolving [943cd5c8802b2a3a64a010efb86ec19bac142e40/lib/ant/ant-contrib.jar]

...

pack.bin:
    [mkdir] Created dir: /Users/xeno_by/Projects/scala/build/pack/bin

pack.done:

build:

BUILD SUCCESSFUL
Total time: 9 minutes 41 seconds</code></pre>

<h3 id='ide'>IDE</h3>

<p>There&#8217;s no single editor of choice for working with Scala sources, as there are trade-offs associated with each available tool.</p>

<p>Both Eclipse and Intellij IDEA have Scala plugins, which are known to work with our codebase. Here are <a href='https://github.com/scala/scala/blob/master/src/eclipse/README.md'>instructions for Eclipse</a> and <a href='https://github.com/scala/scala/blob/master/src/intellij/README'>instructions for Intellij</a>. Both of those Scala plugins provide navigation, refactoring and error reporting functionality as well as integrated debugging. Unfortunately this comes at a cost of occasional sluggishness.</p>

<p>On the other hand, lightweight editors such as Emacs, Sublime or jEdit provide unparalleled scriptability and performance, while lacking semantic services and debugging. To address this shortcoming, they can integrate with ENSIME, a helper program, which hosts a resident Scala compiler providing some of the features implemented in traditional IDEs. However despite having significantly matured over the last year, its support for our particular codebase is still far from being great.</p>

<p>We know of both novices and experienced Scala hackers who&#8217;ve been effective with using both IDEs and lightweight editors. Therefore it&#8217;s hard to recommend a particular tool here, and your choice should boil down to your personal preferences.</p>

<h3 id='3_hack'>3. Hack</h3>

<p>When hacking on your topic of choice, you&#8217;ll be modifying Scala, compiling it and testing it on relevant input files. Typically you would want to first make sure that your changes work on a small example and afterwards verify that nothing break by running a comprehensive test suite.</p>

<p>I&#8217;m going to start by creating a <code>sandbox</code> directory (this particular name doesn&#8217;t bear any special meaning - it&#8217;s just a tribute to my first days in Scala team), which will hold a single test file and its compilation results. First I make sure that <a href='https://issues.scala-lang.org/browse/SI-6725'>the bug</a> is indeed reproducible by throwing together a simple test and feeding it into the Scala distribution assembled by ant in <code>build/pack/bin</code>.</p>

<pre><code>17:25 ~/Projects/scala (ticket/6725)$ mkdir sandbox
17:26 ~/Projects/scala (ticket/6725)$ cd sandbox
17:26 ~/Projects/scala/sandbox (ticket/6725)$ edit Test.scala
17:26 ~/Projects/scala/sandbox (ticket/6725)$ cat Test.scala
object Test extends App {
  val a = 1
  val s = f&quot;$a%s%n$a%s&quot;
  println(s)
}
17:27 ~/Projects/scala/sandbox (ticket/6725)$ ../build/pack/bin/scalac Test.scala
17:28 ~/Projects/scala/sandbox (ticket/6725)$ ../build/pack/bin/scala Test
1%n1 // %n should&#39;ve been replaced by a newline here</code></pre>

<h3 id='implement'>Implement</h3>

<p>There&#8217;s not much to be said about this step, which is bread &amp; butter software development.</p>

<p>Here are also some tips &amp; tricks that have proven useful in Scala development:</p>

<ul>
<li>If after introducing changes or updating your clone, you&#8217;re getting <code>AbstractMethodError</code> or other linkage exceptions, try doing <code>ant clean build</code>. Due to the way how Scala compiles traits, if a trait changes, then it&#8217;s sometimes not enough to recompile just that trait, but it might also be necessary to recompile its users. Ant is not smart enough to do that, which might lead to very strange errors. Full rebuilds fix the problem. Fortunately that&#8217;s rarely necessary, because full rebuilds take significant time.</li>

<li>Even on solid state drives packaging Scala distribution (i.e. creating jars from class files) is a non-trivial task. To save time here, some people in our team do <code>ant quick.comp</code> instead of <code>ant</code> and then create custom scripts to launch Scala from <code>build/quick/classes</code>.</li>

<li>Don&#8217;t underestimate the power of <code>print</code>. When starting with Scala, I spent a lot of time in the debugger trying to figure out how things work. However later I found out that print-based debugging is often more effective than jumping around. While it might be obvious to some, I&#8217;d like to explicitly mention that it&#8217;s also useful to print stack traces to understand the flow of execution.</li>
</ul>

<p>Docs. Right, the docs. The documentation about internal workings of the compiler is scarce, and most of the knowledge is passed around in the form of folklore. However the situation is steadily improving. Here are the resources that might help:</p>

<ul>
<li><a href='TODO'>Compiler internals videos by Martin Odersky</a> are quite dated, but still very useful. In this three-video series Martin explains inner workings of the part of the compiler, which has recently become Scala reflection API.</li>

<li><a href='http://channel9.msdn.com/Events/Lang-NEXT/Lang-NEXT-2012/Reflection-and-Compilers'>Reflection and Compilers by Martin Odersky</a>, a talk at Lang.NEXT 2012 in which Martin elaborates on the design of scalac and the reflection API.</li>

<li><a href='http://docs.scala-lang.org/overviews/reflection/overview.html'>Reflection documentation</a> describes fundamental data structures that are used to represent Scala programs and operations defined on then.</li>

<li><a href='http://lampwww.epfl.ch/~magarcia/ScalaCompilerCornerReloaded/'>Scala compiler corner</a> contains extensive documentation about most of the post-typer phases in the Scala compiler.</li>

<li><a href='http://groups.google.com/group/scala-internals'>scala-internals</a>, a mailing list which hosts discussions about the core internal design and implementation of the Scala system.</li>
</ul>

<h3 id='interlude'>Interlude</h3>

<p>To fix <a href='https://issues.scala-lang.org/browse/SI-6725'>the bug I&#8217;m interested in</a> I&#8217;ve tracked the <code>StringContext.f</code> interpolator down to a macro implemented in <code>MacroImplementations.scala</code>. There I noticed that the interpolator only processes conversions, but not tokens like <code>%n</code>. Looks like an easy fix.</p>

<pre><code>18:44 ~/Projects/scala/sandbox (ticket/6725)$ git diff
diff --git a/src/compiler/scala/tools/reflect/MacroImplementations.scala b/src/compiler/scala/tools/
index 002a3fce82..4e8f02084d 100644
--- a/src/compiler/scala/tools/reflect/MacroImplementations.scala
+++ b/src/compiler/scala/tools/reflect/MacroImplementations.scala
@@ -117,7 +117,8 @@ abstract class MacroImplementations {
       if (!strIsEmpty) {
         val len = str.length
         while (idx &lt; len) {
-          if (str(idx) == &#39;%&#39;) {
+          def notPercentN = str(idx) != &#39;%&#39; || (idx + 1 &lt; len &amp;&amp; str(idx + 1) != &#39;n&#39;)
+          if (str(idx) == &#39;%&#39; &amp;&amp; notPercentN) {
             bldr append (str substring (start, idx)) append &quot;%%&quot;
             start = idx + 1
           }</code></pre>

<p>After I applied the fix and running <code>ant</code>, my simple test case in <code>sandbox/Test.scala</code> started working!</p>

<pre><code>18:51 ~/Projects/scala/sandbox (ticket/6725)$ cd ..
18:51 ~/Projects/scala (ticket/6725)$ ant
Buildfile: /Users/xeno_by/Projects/scala/build.xml

...

quick.comp:
[scalacfork] Compiling 1 file to /Users/xeno_by/Projects/scala/build/quick/classes/compiler
[propertyfile] Updating property file: /Users/xeno_by/Projects/scala/build/quick/classes/compiler/compiler.properties
[stopwatch] [quick.comp.timer: 6.588 sec]

...

BUILD SUCCESSFUL
Total time: 18 seconds

18:51 ~/Projects/scala (ticket/6725)$ cd sandbox
18:51 ~/Projects/scala/sandbox (ticket/6725)$ ../build/pack/bin/scalac Test.scala
18:51 ~/Projects/scala/sandbox (ticket/6725)$ ../build/pack/bin/scala Test
1
1 // no longer getting the %n here - it got transformed into a newline</code></pre>

<h3 id='verify'>Verify</h3>

<p>Now to make sure that my fix doesn&#8217;t break anything I need to run the test suite using the <code>partest</code> tool we wrote to test Scala. Read up <a href='/tutorials/partest-guide.html'>the partest guide</a> to learn the details about partest, but in a nutshell you can either run <code>ant test</code> to go through the entire test suite (30+ minutes) or use wildcards to limit the tests to something manageable:</p>

<pre><code>18:52 ~/Projects/scala/sandbox (ticket/6725)$ cd ../test
18:56 ~/Projects/scala/test (ticket/6725)$ partest files/run/*interpol*
Testing individual files
testing: [...]/files/run/interpolationArgs.scala                      [  OK  ]
testing: [...]/files/run/interpolationMultiline1.scala                [  OK  ]
testing: [...]/files/run/interpolationMultiline2.scala                [  OK  ]
testing: [...]/files/run/sm-interpolator.scala                        [  OK  ]
testing: [...]/files/run/interpolation.scala                          [  OK  ]
testing: [...]/files/run/stringinterpolation_macro-run.scala          [  OK  ]
All of 6 tests were successful (elapsed time: 00:00:08)</code></pre>

<h3 id='4_publish'>4. Publish</h3>

<p>After development is finished, it&#8217;s time to publish the code and submit your patch for discussion and potential inclusion into Scala. In a nutshell this involves: 1) making sure that your code and commit messages are of high quality, 2) clicking a few buttons in the Github interface, 3) assigning one or more reviewers which will look through your pull request. Now all that in more details.</p>

<h3 id='commit'>Commit</h3>

<p>The <a href='http://git-scm.com/book/en/Git-Basics'>Git Basics</a> chapter in the Git online book covers most of the basic workflow during this stage. There are two things you should know here:</p>

<p>1) Commit messages are frequently the only way to communicate with the authors of the code written a few years ago. Therefore, we give them big importance. Be creative and eloquent - the more context your provide for the change you&#8217;ve introduced, the bigger the probability that some future maintainer will get you right. Consult <a href='https://github.com/scala/scala/wiki/Pull-Request-Policy'>the pull request policy</a> for more information about the desired style of your commits.</p>

<p>2) Clean history is also important. Therefore we won&#8217;t accept pull requests for bug fixes that have more than one commit. For features, it is okay to have several commits, but all tests need to pass after every single commit. To clean up your commit structure, you want to <a href='http://git-scm.com/book/en/Git-Branching-Rebasing'>rewrite history</a> using <code>git rebase</code> so that your commits are against the latest revision of <code>master</code>.</p>

<p>Once you are satisfied with your work, synced with <code>master</code> and cleaned up your commits you are ready to submit a patch to the central Scala repository. Before proceeding make sure you have pushed all of your local changes to your fork on Github.</p>

<pre><code>19:22 ~/Projects/scala/test (ticket/6725)$ git add ../src/compiler/scala/tools/reflect/MacroImplementations.scala
19:22 ~/Projects/scala/test (ticket/6725)$ git commit
[ticket/6725 3c3098693b] SI-6725 `f` interpolator now supports %n tokens
 1 file changed, 2 insertions(+), 1 deletion(-)
19:34 ~/Projects/scala/test (ticket/6725)$ git push origin ticket/6725
Username for &#39;https://github.com&#39;: xeno-by
Password for &#39;https://xeno-by@github.com&#39;:
Counting objects: 15, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (8/8), done.
Writing objects: 100% (8/8), 1.00 KiB, done.
Total 8 (delta 5), reused 0 (delta 0)
To https://github.com/xeno-by/scala
 * [new branch]            ticket/6725 -&gt; ticket/6725</code></pre>

<h3 id='submit'>Submit</h3>

<p>This part is very easy and enjoyable. Navigate to your branch in Github (for me it was <code>https://github.com/xeno-by/scala/tree/ticket/6725</code>) and click the pull request button to submit your patch as a pull request to Scala. If you&#8217;ve never submitted patches to Scala, you will need to sign the contributor license agreement, which <a href='http://typesafe.com/tutorials/cla/scala'>can be done online</a> within a few minutes.</p>

<p><img alt='Submit a pull request' src='/tutorials/04-submit.png' /></p>

<h3 id='discuss'>Discuss</h3>

<p>After the pull request has been submitted, you need to pick a reviewer (probably, the person you&#8217;ve contacted in the beginning of your workflow) and be ready to elaborate and adjust your patch if necessary. I picked Martin, because we had such a nice chat on the mailing list:</p>

<p><img alt='Assign the reviewer' src='/tutorials/05-review.png' /></p>
        </div>

        <div class="span5">
          <div id="scroller-anchor">
  <div id="scroller">
    <p class="contents">Contents</p>
    <div id="toc"></div>
  </div>
</div>

        </div>
    
      </div>
	
    </div>
  </div>
  <div class="push"></div>
</div>

<div class="footer">
	<div class="container">
		<ul>
			<li><h5>API</h5></li>
			<li><a href="http://www.scala-lang.org/api/current/">Current</a></li>
			<li><a href="http://www.scala-lang.org/archives/downloads/distrib/files/nightly/docs/library/index.html">Nightly</a></li>
		</ul>
		<ul>
			<li><h5>Learn</h5></li>
			<li><a href="/overviews">Guides & Overviews</a></li>
			<li><a href="/tutorials">Tutorials</a></li>
			<li><a href="/style">Scala Style Guide</a></li>				
		</ul>
		<ul>
			<li><h5>Quickref</h5></li>
			<li><a href="/glossary">Glossary</a></li>
			<li><a href="/cheatsheets">Cheatsheets</a></li>
		</ul>
		<ul>
			<li><h5>Contribute</h5></li>
			<li><a href="http://github.com/scala/scala.github.com">Source Code</a></li>
			<li><a href="/contribute.html">Contributors Guide</a></li>
			<li><a href="http://getsatisfaction.com/scaladocs">Suggestions</a></li>			
		</ul>
		<ul>
			<li><h5>Other Resources</h5></li>
			<li><a href="http://wiki.scala-lang.org">Wiki</a></li>
			<li><a href="/sips">Scala Improvement Process</a></li>				
		</ul>						
	</div>
	<div class="container copyright">
 		<p>
			Copyright &copy; 2011-2013 EPFL. All rights reserved.
			<a href="https://github.com/scala/scala.github.com/commits/gh-pages.atom"><img align="right" height="20px" width="20px" src="/resources/images/rss.png" alt="RSS feed of updates to the github repo hosting this site"></a>
		</p>		
	</div>
</div>


<script type="text/javascript">
  $('#toc').toc({exclude: 'h1, h5, h6', context: '', autoId: true, numerate: false});
</script>

<script type="text/javascript">
  $(function() {
    moveScroller();
  });
</script>

  </body>
</html>

    
